   <div class="row">
            <div class="col-lg-12 mb-3">
                <div class="card p-1">
                <div class="d-flex justify-content-between">
                    <button *ngIf="buttonsPermission.add" class="btn btn-sm btn-info"  (click)="add(addContent)">Ajouter</button>
                     <button *ngIf="selected_data!=null && canTransmit" class="btn btn-sm btn-warning mx-1" (click)="edit(editContent)" nbTooltip="Modifier l'élément" nbTooltipPlacement="top" [disabled]="loading">
                        Reprogrammer la rencontre
                    </button>
                    <button *ngIf="selected_data!=null && canTransmit" class="btn btn-sm btn-danger mx-1" (click)="delete()" nbTooltip="Supprimer l'élément" nbTooltipPlacement="top" [disabled]="loading">
                        Annuler la rencontre
                    </button>
                    <button *ngIf="canTransmit && role!='Directeur'" class=" btn btn-sm btn-primary float-right mx-1" (click)="transUp()" [disabled]="loading">Transmettre</button>
                    <button *ngIf="canSendMail" class=" btn btn-sm btn-primary float-right mx-1" (click)="sendMail()" [disabled]="loading">Envoyer le mail</button>
                    <div class="align-self-center d-flex">
                        <div class="input-group">
                            <select class="form-select" id="inputGroupSelect04" aria-label="Example select with button addon">
                            <option value="">Filtrer Par</option>
                            </select>
                            <input type="text" class="form-control" name="search_text" [(ngModel)]="search_text"   (ngModelChange)="onSearchChange()" placeholder="Rechercher..">
                            <button (click)="resetSearch()" class="btn btn-outline-primary" type="button"><i class="fa fa-rotate-left" aria-hidden="true"></i> </button>
                        </div>
                    </div>
                </div>
                    <div class="card-body">

                                <p>{{isPaginate ? pg.total : data.length}} élément(s)</p>
                                <div class="table-responsive">
                                <table class="table" >
                                    <thead class="">
                                        <tr>
                                            <th style="width: 10px;">#</th>
                                            <th scope="col">Date</th>
                                            <th scope="col">Prestation concernée</th>

                                            <th scope="col">Texte</th>
                                            <th scope="col">Etape</th>
                                            <th scope="col">Statut</th>
                                            <th scope="col">Réponse usager</th>
                                            <th scope="col">Auteur</th>
                                
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let d of data | paginate: {
                                            id:'ngxP1',
                                            itemsPerPage: pg.pageSize,
                                            currentPage: pg.p,
                                            totalItems: pg.total } | sampleSearch:search_text">
                                        <td class="position-relative" style="z-index: 10;"> 
                                            <div class="form-check mb-2">
                                                <input
                                                (click)="checked(d)"
                                                class="form-check-input"
                                                type="radio"
                                                name="selectedDoc"
                                                [value]="d.id"
                                                [(ngModel)]="selectedId"
                                                id="radio-{{ d.id }}"
                                                />
                                            </div>

                                            <div *ngIf="selectedId === d.id" class="overlay-panel-right">
                                                <button
                                                class="btn btn-info btn-sm btn-label waves-effect waves-light me-3 mb-1"
                                                (click)="add(addContent)"
                                                title="Ajouter"
                                                matTooltip="Ajouter"
                                                [disabled]="loading"
                                                >
                                                <i class="bi bi-plus-lg"></i>
                                                </button>

                                                <button
                                                *ngIf="buttonsPermission.show"
                                                (click)="show(showContent)"
                                                type="button"
                                                class="btn btn-outline-primary btn-sm btn-label waves-effect waves-light mb-1 me-3"
                                                title="Consulter"
                                                matTooltip="Consulter"
                                                [disabled]="loading"
                                                >
                                                <i class="bi bi-eye"></i>
                                                </button>

                                                <button
                                                *ngIf="buttonsPermission.edit"
                                                (click)="edit(editContent)"
                                                type="button"
                                                class="btn btn-outline-warning btn-sm btn-label waves-effect waves-light mb-1 me-3"
                                                title="Éditer"
                                                matTooltip="Éditer"
                                                [disabled]="loading"
                                                >
                                                <i class="bi bi-pencil"></i>
                                                </button>

                                                <button
                                                *ngIf="buttonsPermission.delete"
                                                (click)="delete()"
                                                type="button"
                                                class="btn btn-outline-danger btn-sm btn-label waves-effect waves-light me-3 mb-1"
                                                title="Supprimer"
                                                matTooltip="Supprimer"
                                                [disabled]="loading"

                                                >
                                                <i class="bi bi-trash"></i>
                                                </button>

                                                <button
                                                *ngIf="is_active != null && !is_active"
                                                (click)="setStatus(1)"
                                                type="button"
                                                class="btn btn-outline-success btn-sm btn-label waves-effect waves-light me-3 mb-1"
                                                title="Activer"
                                                matTooltip="Activer"
                                                [disabled]="loading"
                                                >
                                                <i class="bi bi-toggle-on"></i>
                                                </button>

                                                <button
                                                *ngIf="is_active != null && is_active"
                                                (click)="setStatus(0)"
                                                type="button"
                                                class="btn btn-outline-danger btn-sm btn-label waves-effect waves-light me-3 mb-1"
                                                title="Désactiver"
                                                matTooltip="Désactiver"
                                                [disabled]="loading"

                                                >
                                                <i class="bi bi-toggle-off"></i>
                                                </button>

                                          

                                                <button
                                                type="button"
                                                class="btn-close float-end"
                                                (click)="selectedId = null"
                                                title="Fermer"
                                                matTooltip="Fermer"
                                                ></button>
                                            </div>
                                            </td>

                                            <td>{{d?.date_start | date:"dd-MM-yyyy"}}</td>
                    <td>{{d?.requete?.prestation?.name}}</td>

                    <td>{{d?.description}}</td>
                   
                    <td>{{d?.unite_admin?.libelle}}</td>
                    <td>{{getStatus(d?.status)}}</td>
                    <td>{{d?.usager_response==null ?"En attente de réponse":d?.usager_response==0?"Pas disponible":"Diponible"}}</td>
                    <td>{{d.user?.agent?.lastname}} {{d.user?.agent?.firstname}}</td>

                                        </tr>

                                    <tr *ngIf="search_text !== '' && (data | sampleSearch:search_text).length === 0">
                                        <td colspan="5" class="text-center">
                                            <p class="text-muted">Recherche avancée en cours...</p>
                                            <button class="btn btn-outline-secondary btn-sm" (click)="resetSearch()">
                                                Réinitialiser la recherche
                                                </button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                                </div>
                                <pagination-controls 
                                id="ngxP1"
                                (pageChange)="getPage($event)"
                              [maxSize]="9"
                              [directionLinks]="true"
                              [autoHide]="true"
                              [responsive]="true"
                              [previousLabel]="'Précédent'"
                              [nextLabel]="'Suivant'"
                              [screenReaderPaginationLabel]="'Pagination'"
                              [screenReaderPageLabel]="'page'"
                              [screenReaderCurrentLabel]="'Vous êtes sur la page'">
                            </pagination-controls>

                    </div><!-- end card -->
                </div>
            </div>
        </div>
  
    <ng-template #addContent let-c="close" let-d="dismiss">
        <form #addForm="ngForm" (ngSubmit)="store(addForm.value)">
            <div class="modal-header">
                <h4 class="modal-title" id="modal-basic-title">Enregistrer un programme</h4>
                <button type="button" class="btn btn-dark"  (click)="d('Cross click')"> <i class="fa fa-times"></i></button>
            </div>
      <div>

        <div class="modal-body">

            <div class="form-group">
                <label for="">Choisir la prestation</label>
                <select name="" id="" class="form-control" (change)="loadRequete($event)" [disabled]="upId != undefined">
                    <option selected disabled></option>
                    <option *ngFor="let up of user_prestations" [selected]="upId==up.id" [value]="up.prestation.id">{{up.prestation.name}}</option>
                </select>
            </div>

            <div class="form-group" *ngIf="code ==undefined">
                <label for="">Choisir la requête</label>
                <select class="form-control" ngModel name="requete_id" required >
                    <option selected disabled></option>
                    <option *ngFor="let req of requetes" [selected]="code==reqId" [value]="req.id">{{req.code}}</option>
                </select>
            </div>
             
            <div class="form-group" *ngIf="code !=undefined">
                <label for="">Choisir la requête</label>
                <select class="form-control" [(ngModel)]="reqId" name="requete_id" required disabled>
                    <option selected disabled></option>
                    <option *ngFor="let req of requetes" [value]="req.id">{{req.code}}</option>
                </select>
            </div>
 
                <div class="form-group">
                    <label for="typeLabel">Texte</label>
                    <textarea  #description="ngModel" name="description" ngModel class="form-control" rows="5"></textarea>
                    <span *ngIf="description.invalid && (description.dirty || description.touched)" class="text-danger">
                        <small *ngIf="description.errors?.['required']" id="typeLabelHelp" class="form-text">Le libellé est requis.</small>
                    </span>
                </div>
              
                <div class="form-group">
                    <label for="typeLabel">Date </label>
                    <input type="datetime-local" class="form-control" id="typeLabel" aria-describedby="typeLabelHelp" required #date_start="ngModel" name="date_start" ngModel>
                    <span *ngIf="date_start.invalid && (date_start.dirty || date_start.touched)" class="text-danger">
                        <small *ngIf="date_start.errors?.['required']" id="typeLabelHelp" class="form-text">Le libellé est requis.</small>
                    </span>
                </div>
              
      </div>
    </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-outline-primary" [disabled]="addForm.invalid || loading">Sauvegarder <app-loading [isVisible]="loading"></app-loading> </button>
      </div>
    
</form>
  </ng-template>

  <ng-template #editContent  let-c="close" let-d="dismiss">
    <form #editForm="ngForm" (ngSubmit)="update(editForm.value)">
    <div style="height: 80vh;">
      <div>
        <h6>Modification de programme
            <button type="button" class="btn btn-dark"  (click)="d('Cross click')"> <i class="fa fa-times"></i></button>
        </h6>
      </div>
      <div >

     
        <div class="form-group">
            <label for="typeLabel">Texte</label>
            <textarea  #description="ngModel" name="description" [(ngModel)]="selected_data.description" class="form-control" rows="5"></textarea>
            <span *ngIf="description.invalid && (description.dirty || description.touched)" class="text-danger">
                <small *ngIf="description.errors?.['required']" id="typeLabelHelp" class="form-text">Le libellé est requis.</small>
            </span>
        </div>
     
        <div class="form-group">
            <label for="typeLabel">Date</label>
            <input type="datetime-local" class="form-control" id="typeLabel" aria-describedby="typeLabelHelp" required #date_start="ngModel" name="date_start" [(ngModel)]="selected_data.date_start">
            <span *ngIf="date_start.invalid && (date_start.dirty || date_start.touched)" class="text-danger">
                <small *ngIf="date_start.errors?.['required']" id="typeLabelHelp" class="form-text">Le libellé est requis.</small>
            </span>
        </div>
      
</div>
      <div>
        <button type="submit" class="btn btn-outline-primary" [disabled]="editForm.invalid || loading">Sauvegarder <app-loading [isVisible]="loading"></app-loading> </button>
      </div>
    
    </div>
</form>
  </ng-template>
  <ng-template #showContent let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Détails des informations</h4>
		<button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
      </div>

      <div class="modal-body">
        <div class="table-responsive table-card">
       
        </div>
      </div>
</ng-template>